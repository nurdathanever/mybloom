{% extends 'base.html' %}
{% block title %}Shopping Cart{% endblock %}
{% block content %}
<div class="container my-5">
    <h2 class="text-center mb-4">Shopping Cart</h2>
    {% if cart_items %}
    <ul class="list-group mb-3">
        {% for cart_item in cart_items %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
                {% if cart_item.image %}
                    <img src="{{ cart_item.image }}" width="300" height="300" class="me-3 rounded">
                {% endif %}
                <strong>{{ cart_item.item.custom_bouquet.description }}</strong><br>
                Added: {{ cart_item.date|date:"Y-m-d H:i" }}
                <ul class="mt-2 mb-0">
                    {% for flower in cart_item.flowers %}
                        <li>{{ flower.product.name }} x {{ flower.quantity }}</li>
                    {% endfor %}
                    {% for acc in cart_item.accessories %}
                        <li>{{ acc.product.name }} ({{ acc.accessory_type|capfirst }})</li>
                    {% endfor %}
                </ul>
            </div>
            <div>
                {{ cart_item.item.total_price }} KZT
                <a href="{% url 'remove_from_cart' cart_item.item.id %}" class="btn btn-sm btn-danger ms-2">Remove</a>
            </div>
        </li>
        {% endfor %}
    </ul>
    <h5 class="text-end">Total: <strong>{{ total }} KZT</strong></h5>
    <div class="text-end">
        <a href="#" class="btn btn-success btn-lg">Checkout</a>
    </div>
    {% else %}
    <div class="alert alert-info text-center">Your cart is empty.</div>
    {% endif %}
</div>
{% endblock %}